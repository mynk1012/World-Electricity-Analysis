Q1 Access to electricity

SELECT COUNTRYNAME, AVG(r.Y2001 + r.Y2002+ r.Y2003 + r.Y2004 + r.Y2005 + r.Y2006 + r.Y2007 
+ r.Y2008 + r.Y2009 +r.Y2010 + r.Y2011 + r.Y2012 + r.Y2013 + r.Y2014 +r.Y2015 + r.Y2016 +r.Y2017 +
r.Y2018 + r.Y2019 + r.Y2020 + r.Y2021) ag FROM rural r join urban u on r.countrycode=u.countrycode
GROUP BY 
COUNTRYNAME;


Q2 insights

SELECT Y2014 FROM nuclear
WHERE Y2014 IS NULL OR Y2014 = 0


Q3 world avg compare

WITH CTE AS(
SELECT SUM(Y2000)/266 WVG2000,SUM(Y2001)/266 WVG2001,SUM(Y2002)/266 WVG2002,
SUM(Y2003)/266 WVG2003,SUM(Y2004)/266 WVG2004,SUM(Y2005)/266 WVG2005,SUM(Y2006)/266 WVG2006,SUM(Y2007)/266 WVG2007,
SUM(Y2008)/266 WVG2008,SUM(Y2009)/266 WVG2009,SUM(Y2010)/266 WVG2010
FROM TOTAL
)

SELECT CountryName,WVG2000 WORLD_AVG_2000,Y2000,WVG2001,Y2001,WVG2002,Y2002,WVG2003,Y2003,WVG2004,Y2004,
WVG2005,Y2005,WVG2006,Y2006,WVG2007,Y2007,WVG2008,Y2008,WVG2009,Y2009,WVG2010,Y2010
FROM total,CTE

Q4 COUNT OF COUNTRY GREATER THAN 75%

WITH CTE AS
(SELECT CountryName,IndicatorName,Y1990 FROM rural),
CTE2 AS
(SELECT CountryName,IndicatorName,Y1991 FROM rural),
CTE3 AS
(SELECT CountryName,IndicatorName,Y1992 FROM rural),
CTE4 AS
(SELECT CountryName,IndicatorName,Y1993 FROM rural),
CTE5 AS
(SELECT CountryName,IndicatorName,Y1994 FROM rural),
CTE6 AS
(SELECT CountryName,IndicatorName,Y1995 FROM rural),
CTE7 AS
(SELECT CountryName,IndicatorName,Y1996 FROM rural),
CTE8 AS
(SELECT CountryName,IndicatorName,Y1997 FROM rural),
CTE9 AS
(SELECT CountryName,IndicatorName,Y1998 FROM rural),
CTE10 AS
(SELECT CountryName,IndicatorName,Y1999 FROM rural),
CTE10A AS
(SELECT CountryName,IndicatorName,Y2000 FROM rural),
CTE11 AS
(SELECT CountryName,IndicatorName,Y2001 FROM rural),
CTE12 AS
(SELECT CountryName,IndicatorName,Y2002 FROM rural),
CTE13 AS
(SELECT CountryName,IndicatorName,Y2003 FROM rural),
CTE14 AS
(SELECT CountryName,IndicatorName,Y2004 FROM rural),
CTE15 AS
(SELECT CountryName,IndicatorName,Y2005 FROM rural),
CTE16 AS
(SELECT CountryName,IndicatorName,Y2006 FROM rural),
CTE17 AS
(SELECT CountryName,IndicatorName,Y2007 FROM rural),
CTE18 AS
(SELECT CountryName,IndicatorName,Y2008 FROM rural),
CTE19 AS
(SELECT CountryName,IndicatorName,Y2009 FROM rural),
CTE20 AS
(SELECT CountryName,IndicatorName,Y2010 FROM rural),
CTE21 AS
(SELECT CountryName,IndicatorName,Y2011 FROM rural),
CTE22 AS
(SELECT CountryName,IndicatorName,Y2012 FROM rural),
CTE23 AS
(SELECT CountryName,IndicatorName,Y2013 FROM rural),
CTE24 AS
(SELECT CountryName,IndicatorName,Y2014 FROM rural),
CTE25 AS
(SELECT CountryName,IndicatorName,Y2015 FROM rural),
CTE26 AS
(SELECT CountryName,IndicatorName,Y2016 FROM rural),
CTE27 AS
(SELECT CountryName,IndicatorName,Y2017 FROM rural),
CTE28 AS
(SELECT CountryName,IndicatorName,Y2018 FROM rural),
CTE29 AS
(SELECT CountryName,IndicatorName,Y2019 FROM rural),
CTE30 AS
(SELECT CountryName,IndicatorName,Y2020 FROM rural)


SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE
WHERE Y1990>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE2
WHERE Y1991>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE3
WHERE Y1992>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE4
WHERE Y1993>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE5
WHERE Y1994>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE6
WHERE Y1995>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE7
WHERE Y1996>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE8
WHERE Y1997>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE9
WHERE Y1998>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE10
WHERE Y1999>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE10A
WHERE Y2000>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE11
WHERE Y2001>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE12
WHERE Y2002>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE13
WHERE Y2003>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE14
WHERE Y2004>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE15
WHERE Y2005>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE16
WHERE Y2006>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE17
WHERE Y2007>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE18
WHERE Y2008>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE19
WHERE Y2009>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE20
WHERE Y2010>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE21
WHERE Y2011>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE22
WHERE Y2012>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE23
WHERE Y2013>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE24
WHERE Y2014>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE25
WHERE Y2015>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE26
WHERE Y2016>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE27
WHERE Y2017>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE28
WHERE Y2018>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE29
WHERE Y2019>74
GROUP BY IndicatorName
UNION
SELECT IndicatorName,COUNT(CountryName) COUNT_COUNTRY
FROM CTE30
WHERE Y2020>74
GROUP BY IndicatorName

Q5 Group by region and income group

SELECT REGION,IncomeGroup,Y2001,Y2002,Y2003,Y2004,Y2005,Y2006,Y2007,Y2008,Y2009,Y2010,Y2011,Y2012,Y2013,Y2014,Y2015,
Y2016,Y2017,Y2018,Y2019,Y2020,COUNT(Country_Code) CN
FROM NUCLEAR N JOIN METADATA M ON N.CountryCode=M.Country_Code
GROUP BY REGION,IncomeGroup,Y2001,Y2002,Y2003,Y2004,Y2005,Y2006,Y2007,Y2008,Y2009,Y2010,Y2011,Y2012,Y2013,Y2014,Y2015,
Y2016,Y2017,Y2018,Y2019,Y2020

Q6 Combining all the tables

SELECT * FROM nuclear
union
SELECT * FROM rural
UNION
SELECT * FROM urban
UNION
SELECT * FROM oil
UNION
SELECT * FROM total
UNION
SELECT * FROM renewable
UNION 
SELECT * FROM POWER
ORDER BY CountryName


